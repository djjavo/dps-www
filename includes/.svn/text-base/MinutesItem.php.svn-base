<?php
class MinutesItem {
	protected $id;
	protected $meeting_id;
	protected $title;
	protected $description;
	protected $ordering;
	
	function __construct($meeting_id){
		if(!is_numeric($meeting_id)){
			trigger_error("No meeting id supplied");
			return false;
		}
		$this->meeting_id = $meeting_id;
	}
	
	public function getID(){
		return $this->id;
	}
	public function getMeetingID(){
		return $this->meeting_id;
	}
	public function getTitle(){
		return $this->title;
	}
	public function getDescription(){
		return $this->description;
	}
	public function getOrder(){
		return $this->ordering;
	}
	
	public function setTitle($input){
		$this->title = $input;
	}
	public function setDescription($input){
		$this->description = $input;
	}
	public function setOrder($input){
		if(!is_numeric($input)){
			return false;
		}else{
			$this->ordering = $input;
			return true;
		}
	}
	
	public function save(){
		if(is_null($this->id))
			return $this->insert();
		else
			return $this->update();
	}
	public function insert(){
		$result = RawDB::query("INSERT INTO web_minutes_items (meeting_id, title, description, ordering) VALUES (".pg_escape_string($this->meeting_id).", '".pg_escape_string($this->title)."', '".pg_escape_string($this->description)."', ".pg_escape_string($this->ordering).") RETURNING id");
		if($result){
			$row = pg_fetch_row($result);
			$this->id = $row[0];
			return true;
		}else{
			return false;
		}
	}
	public function update(){
		return RawDB::query("UPDATE web_minutes_items SET title='".pg_escape_string($this->title)."', description='".pg_escape_string($this->description)."', ordering=".pg_escape_string($this->ordering)." WHERE id = ".$this->id);
	}
	
	public function delete(){
		return RawDB::query("DELETE FROM web_minutes_items WHERE id = '".$this->id."'");
	}
}