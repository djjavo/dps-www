<?php
class Meetings {
	public static function getByID($input){
		if(is_numeric($input)){
			$result = RawDB::query("SELECT * FROM web_meetings WHERE meeting_id = ".$input);
			return pg_fetch_object($result, NULL, 'Meeting');
		}else{
			trigger_error("Input must be numeric", E_USER_ERROR);
		}
	}
	public static function getByTimeSpan($start = NULL, $finish = NULL){
		$query = "SELECT * FROM web_meetings WHERE ";
		if(is_null($start) && is_null($finish)){
			trigger_error("At least one time must be supplied", E_USER_ERROR);
			return false;
		}
		if(!is_null($start)){
			if(is_numeric($start)){
				$query .= "meeting_time >= ".$start." ";
				if(!is_null($finish) && is_numeric($finish))
					$query .= "AND ";
			} else {
				trigger_error("Start must be Timestamp", E_USER_ERROR);
				return false;
			}
		}
		if(!is_null($finish)){
			if(is_numeric($finish)){
				$query .= "meeting_time =< ".$finish." ";
			} else {
				trigger_error("Finish must be Timestamp", E_USER_ERROR);
				return false;
			}
		}
		$query .= "ORDER BY meeting_time DESC";
		$result = RawDB::query($query);
		while($object = pg_fetch_object($result, NULL, 'Meeting'))
			$return[] = $object;
		return $return;
	}
	public static function getAll(){
		$result = RawDB::query("SELECT * FROM web_meetings ORDER BY meeting_time DESC");
		$return = array();
		while($object = pg_fetch_object($result, NULL, 'Meeting'))
			$return[] = $object;
		return $return;
	}
}