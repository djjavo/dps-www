<?php
class Media {

	protected static $audioplayer_count;
	protected static $flvplayer_count;

	public static function youtube($videoid, $width=425, $height=344) {
		return '<object width="'.$width.'" height="'.$height.'"><param name="movie" value="http://www.youtube.com/v/'.$videoid.'&hl=en&fs=1"></param><param name="allowFullScreen" value="true"></param><embed src="http://www.youtube.com/v/'.$videoid.'&hl=en&fs=1" type="application/x-shockwave-flash" allowfullscreen="true" width="'.$width.'" height="'.$height.'"></embed></object>';
	}

	public static function audio($path, $www = FALSE) {
		if(!isset(self::$audioplayer_count)) {
			Output::add_script(SITE_LINK_REL.'js/audio-player.js');
			self::$audioplayer_count = 0;
		}
		self::$audioplayer_count++;
		if ($www) {
			$path = SITE_LINK_ABS . $path;
		} else {
			$path = SITE_LINK_MEDIA . $path;
		}
		return '<object type="application/x-shockwave-flash" data="'.SITE_LINK_REL.'js/player.swf" id="audioplayer'.self::$audioplayer_count.'" height="24" width="290" style="outline:none;">
			<param name="movie" value="'.SITE_LINK_REL.'js/player.swf" />
			<param name="FlashVars" value="playerID='.self::$audioplayer_count.'&amp;soundFile='.$path.'" />
			<param name="quality" value="high" />
			<param name="menu" value="false" />
			<param name="wmode" value="transparent" />
			</object>';
	}

	public static function generate($type, $addr) {
		if($type=='audio') {
			return self::audio($addr);
		} elseif ($type=='youtube') {
			return self::youtube($addr);
		}
	}
	
	public static function podcast($id) {
		$podcast = PodcastEntries::get($id);
		$addr = "podcasts/". $podcast->get_filename();
		return self::audio($addr);
	}

	public static function moreraw($id) {
		return self::podcast($id);
	}
	
	public static function flv($path) {
		if(!isset(self::$flvplayer_count)) {
			Output::add_script(SITE_LINK_REL.'js/flvplayer.js');
			self::$flvplayer_count = 0;
		}
		self::$flvplayer_count++;

		return '<object id="player" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" name="player" width="400" height="315">
		<param name="movie" value="'.SITE_LINK_REL.'js/flvplayer.swf" />
		<param name="allowfullscreen" value="true" />
		<param name="allowscriptaccess" value="always" />
		<param name="flashvars" value="file='.SITE_LINK_MEDIA .$path.'" />
		<embed
			type="application/x-shockwave-flash"
			id="player'.self::$flvplayer_count.'"
			name="player'.self::$flvplayer_count.'"
			src="'.SITE_LINK_REL.'js/flvplayer.swf" 
			width="400" 
			height="315"
			allowscriptaccess="always" 
			allowfullscreen="true"
			flashvars="file='.SITE_LINK_MEDIA .$path.'" 
		/>
		</object>';
	}

}
?>

